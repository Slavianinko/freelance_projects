# Построение модели прогнозирования обращений в лечебные учреждения.

Статус проекта: | В плане :black_square_button: | Выполняется :black_square_button: | Завершён :white_check_mark: | 
:------------ | :-------------| :-------------| :-------------

## Задача:

Требуется создать модель предсказания факта обращения застрахованного в январе 2022. Т.е., требуется классифицировать застрахованных на 2 класса: 1 - застрахованный обратился в январе 2022 года, 0 - застрахованный не обратился в январе 22 года.

## Данные:

Представленны данные об обращении застрахованных по ДМС в лечебные учреждения за 2021 год с указанием даты обращения, количества полученных медицинских услуг и их суммарной стоимости. Кроме того, доступна информация о поле и возрасте пациентов.

## Используемые библиотеки
- pandas
- numpy
- sklearn
- tsfrash
- catboost
- lightGBM
- matplotlib
- seaborn
- shap

## Отработанные методы и навыки
- Исследовательский анализ данных;
- Построение моделей машинного обучения(линейная модель, дерево решений, случайный лес, CatBoostRegressor, LightGBMRegressor);
- Улучшение качества моделей(подбор гиперпараметров, кроссвалидация);
- Работа с временными рядами;
- Проверка моделей на адекватность.

## Решение задачи

### [Первый способ решения.](Test_task.ipynb) 

В основе первого способа решения было извлечение признаков временных рядов с помощью библиотеки tsfrash, и последующее обучение модели на полученных данных с валидецией и тестом на части данных января 2022 года. Качество модели получилось удовлетворительным. ROC-AUC = 0.77. Наибольшую значимость показывал признак последнего дня обращения клиента за мед помощью.

### [Второй способ решения.](Test_task_2.ipynb)

После представления первого решения, бизнес-задача была уточнена. Требовалось создать модель, которая бы работала для любого месяца без привязки к конкретным датам. В основе данного решения, было приведение данных по каждому клиенту к временному ряду по месяцам и создание признаков с временными лагами и скользящим средним по этому временному ряду. Задача была решена с хорошим качеством ROC-AUC = 0.73.

## Итоги проекта

Несмотря на то, что модель созданная во втором способе решения показала несколько худшую метрику качества, она в большей степени удовлетворяет потребности бизнеса. 
